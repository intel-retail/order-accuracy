minio:
  endpoint: minio:9000
  access_key: minioadmin
  secret_key: minioadmin
  secure: false

buckets:
  frames: frames
  selected: selected

video:
  default_source: /videos/sample.mp4
  fps_target: 1

frame_selector:
 # Increased from 3 to capture items that appear later in order
  poll_interval_sec: 1.5
  skip_labels:
    - hand
    - person
  min_frames_per_order: 1  # Reduced to capture brief orders like 384
  min_frames_before_finalize: 5  # Wait for at least N frames before finalizing an order

# Order Tracker Configuration - Robust frame accumulation and finalization
order_tracker:
  # Finalization timing
  inactivity_timeout_seconds: 5.0      # Time without new frames before considering finalization
  minimum_collection_time_seconds: 2.0  # Minimum tracking time before allowing finalization
  
  # Grace period - continue collecting frames after OCR stops detecting order
  grace_frame_count: 3                  # Number of additional frames to collect
  
  # Frame selection
  top_k_frames: 3                       # Maximum frames to select for VLM
  min_frames_soft_requirement: 3        # Warn if below this (but don't block)
  min_frames_hard_requirement: 1        # Skip orders with fewer frames
  
  # Quality scoring penalties (0.0 = no penalty, 1.0 = max penalty)
  occlusion_penalty: 0.3                # Penalty for frames with hands/persons
  blur_penalty: 0.2                     # Penalty for blurry frames
  item_count_weight: 0.1                # Bonus weight per detected item
  
  # Background processing
  enable_background_finalization: true
  finalization_check_interval: 1.0

vlm:
  # Backend type: 'embedded' (local OpenVINO GenAI) or 'ovms' (OpenVINO Model Server)
  backend: ovms  # Using OVMS backend for VLM inference
  
  # Embedded backend configuration (used when backend: embedded)
  model_path: /model/Qwen2.5-VL-7B-Instruct
  device: GPU
  
  # OVMS backend configuration (used when backend: ovms)
  ovms_endpoint: http://ovms-vlm:8000
  ovms_model: Qwen/Qwen2.5-VL-7B-Instruct

  # Common configuration
  endpoint: http://order-accuracy:8000/run_vlm
  retries: 5
  timeout_sec: 120  # Increased for OVMS network latency
  max_new_tokens: 512
  temperature: 0.2
  model: Qwen/Qwen2.5-VL-7B-Instruct
  precision: int8

# Semantic Comparison Service Configuration
semantic_service:
  endpoint: http://semantic-service:8080
  enabled: true  # Enabled - using external semantic comparison service
  timeout: 30
  fallback_to_local: true  # Use local semantic matching if service unavailable

ocr:
  prefer_digits: 3

inventory:
  - green apple
  - apple
  - water bottle
  - coke 2 liter bottle
  - coke large bottle
  - coke bottle
  - pepsi can
  - banana
